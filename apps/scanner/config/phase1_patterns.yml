# Phase 1 Strict Pattern Configuration
# Only the 11 approved PII types for initial rollout
# Last Updated: 2026-01-08

patterns:
  # Government IDs - India
  PAN:
    regex: '(?i)\b(?:panNumber\s*:\s*|PAN\s*:\s*|panNo\s*=\s*|pan\s*:\s*|<)?\s*[A-Z]{5}[0-9]{4}[A-Z]\s*(?:>)?\b'
    severity: CRITICAL
    category: "Sensitive Personal Data"
    enabled: true
    
  Aadhaar:
    regex: '\b\d{4}[-\s]?\d{4}[-\s]?\d{4}\b'
    severity: CRITICAL
    category: "Sensitive Personal Data"
    enabled: true
    validator: verhoeff
    
  Passport_India:
    regex: '\b[A-Z]\d{7}\b'
    severity: CRITICAL
    category: "Sensitive Personal Data"
    enabled: true
    
  Voter_ID_EPIC:
    regex: '\b[A-Z]{3}\d{7}\b'
    severity: HIGH
    category: "Sensitive Personal Data"
    enabled: true
    
  Driving_License_India:
    regex: '(?i)(?:dl|license)[#:\s]+[A-Z]{2}\d{13}'
    severity: HIGH
    category: "Sensitive Personal Data"
    enabled: true

  # Financial Data
  Credit_Card:
    regex: '\b(?:4\d{3}|5[1-5]\d{2}|3[47]\d{2}|6(?:011|5\d{2}))[-\s]?\d{4}[-\s]?\d{4}[-\s]?\d{4}\b'
    severity: CRITICAL
    category: "Sensitive Personal Data"
    enabled: true
    validator: luhn
    
  UPI_ID:
    regex: '(?i)\b[a-z0-9._-]+@[a-z]{3,}\b'
    severity: HIGH
    category: "Personal Data"
    enabled: true
    
  IFSC_Code:
    regex: '\b[A-Z]{4}0[A-Z0-9]{6}\b'
    severity: MEDIUM
    category: "Personal Data"
    enabled: true
    
  Bank_Account_Number:
    regex: '(?i)(?:account|acct)[_\s]?(?:number|no|num)[\s:=]+\d{9,18}'
    severity: CRITICAL
    category: "Sensitive Personal Data"
    enabled: true

  # Contact Information
  Phone_Number:
    regex: '\b[6-9]\d{9}\b'
    severity: MEDIUM
    category: "Personal Data"
    enabled: true
    
  Email:
    regex: '(?i)\b[A-Za-z0-9]([A-Za-z0-9._%+-]{0,63})@[A-Za-z0-9]([A-Za-z0-9.-]{0,253})\.[A-Za-z]{2,63}\b'
    severity: MEDIUM
    category: "Personal Data"
    enabled: true

# Configuration metadata
metadata:
  version: "1.0-phase1"
  total_patterns: 11
  strict_mode: true
  description: "Phase 1 approved patterns only - enterprise-grade validation"
  
# Validator mappings
validators:
  verhoeff:
    applies_to: ["Aadhaar"]
    description: "Verhoeff checksum algorithm"
    
  luhn:
    applies_to: ["Credit_Card"]
    description: "Luhn algorithm for credit card validation"
    
  pan_format:
    applies_to: ["PAN"]
    description: "PAN format validator (5 letters, 4 digits, 1 letter)"
